<template>
    <div class="slds-grid slds-gutters slds-wrap slds-var-p-around_medium">
        <div class="slds-large-size_1-of-1 slds-small-size_1-of-1 slds-col">
            <div class="slds-page-header">
                <div class="slds-page-header__row">
                    <div class="slds-page-header__col-title">
                        <div class="slds-media">
                            <div class="slds-media__figure">
                                <span
                                    class="
                                        slds-icon_container
                                        slds-icon-standard-news
                                    "
                                >
                                    <svg
                                        class="slds-icon slds-page-header__icon"
                                        aria-hidden="true"
                                    >
                                        <use
                                            xlink:href="/icons/standard-sprite/svg/symbols.svg#news"
                                        ></use>
                                    </svg>
                                </span>
                            </div>
                            <div class="slds-media__body">
                                <div class="slds-page-header__name">
                                    <div class="slds-page-header__name-title">
                                        <h1>
                                            <span>Birding News</span>
                                            <span
                                                class="
                                                    slds-page-header__title
                                                    slds-truncate
                                                "
                                                title={dropdown}
                                            >
                                                {dropdown}
                                            </span>
                                        </h1>
                                    </div>
                                    <div
                                        class="slds-page-header__name-switcher"
                                    >
                                        <div
                                            class="
                                                list-select
                                                slds-dropdown-trigger
                                                slds-dropdown-trigger_click
                                            "
                                        >
                                            <button
                                                class="
                                                    slds-button
                                                    slds-button_icon
                                                    slds-button_icon-small
                                                "
                                                aria-haspopup="true"
                                                title="Switch list view"
                                                onclick={handleListClick}
                                            >
                                                <svg
                                                    class="
                                                        slds-button__icon
                                                        slds-icon_x-small
                                                    "
                                                    aria-hidden="true"
                                                >
                                                    <use
                                                        xlink:href="/icons/utility-sprite/svg/symbols.svg#down"
                                                    ></use>
                                                </svg>
                                                <span
                                                    class="slds-assistive-text"
                                                >
                                                    Switch list view
                                                </span>
                                            </button>
                                            <div
                                                class="
                                                    slds-dropdown
                                                    slds-dropdown_left
                                                "
                                            >
                                                <ul
                                                    class="slds-dropdown__list"
                                                    role="menu"
                                                    aria-label="Show More"
                                                >
                                                    <template
                                                        for:each={dropdownOptions}
                                                        for:item="option"
                                                    >
                                                        <li
                                                            key={option._id}
                                                            class="
                                                                slds-dropdown__item
                                                            "
                                                            role="presentation"
                                                            onclick={handleOptionChange}
                                                            data-id={option.title}
                                                        >
                                                            <a
                                                                href="#"
                                                                role="menuitem"
                                                                tabindex="0"
                                                            >
                                                                <span
                                                                    class="
                                                                        slds-truncate
                                                                    "
                                                                    title={option.title}
                                                                >
                                                                    {option.title}
                                                                </span>
                                                            </a>
                                                        </li>
                                                    </template>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-page-header__col-actions">
                        <div class="slds-page-header__controls">
                            <div class="slds-page-header__control"></div>
                        </div>
                    </div>
                </div>
                <div class="slds-page-header__row">
                    <div class="slds-page-header__col-meta">
                        <p class="slds-page-header__meta-text">
                            {numItems} items â€¢ Updated {timeElapsed}
                            <lightning-formatted-date-time
                                value={lastUpdatedDate}
                                year="numeric"
                                month="long"
                                day="2-digit"
                                hour="2-digit"
                                minute="2-digit"
                                hour12="true"
                            ></lightning-formatted-date-time>
                        </p>
                    </div>
                    <div class="slds-page-header__col-controls">
                        <div class="slds-page-header__controls">
                            <div class="slds-page-header__control">
                                <button
                                    class="
                                        slds-button
                                        slds-button_icon
                                        slds-button_icon-border-filled
                                    "
                                    title="Refresh List"
                                    onclick={refresh}
                                >
                                    <svg
                                        class="slds-button__icon"
                                        aria-hidden="true"
                                    >
                                        <use
                                            xlink:href="/icons/utility-sprite/svg/symbols.svg#refresh"
                                        ></use>
                                    </svg>
                                    <span class="slds-assistive-text">
                                        Refresh List
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div
            class="
                slds-large-size_1-of-1
                slds-small-size_1-of-1
                slds-col
                slds-var-p-top_small
            "
        >
            <template if:true={news}>
                <article class="slds-card">
                    <div class="slds-card__header slds-grid">
                        <header
                            class="
                                slds-media slds-media_center
                                slds-has-flexi-truncate
                            "
                        >
                            <div class="slds-media__figure">
                                <span
                                    class="
                                        slds-icon_container
                                        slds-icon-standard-news
                                    "
                                    title="news"
                                >
                                    <svg
                                        class="slds-icon slds-icon_medium"
                                        aria-hidden="true"
                                    >
                                        <use
                                            xlink:href="/icons/standard-sprite/svg/symbols.svg#news"
                                        ></use>
                                    </svg>
                                </span>
                            </div>
                            <div class="slds-media__body">
                                <h2 class="slds-card__header-title">
                                    Birding News
                                </h2>
                            </div>
                        </header>
                    </div>
                    <div
                        class="
                            slds-card__body slds-card__body_inner
                            slds-scrollable_y
                        "
                        style="height: 600px"
                    >
                        <template for:each={birdNews} for:item="item">
                            <div key={item.id} class="slds-p-bottom_small">
                                <template if:true={item.isLink}>
                                    <a href={item.link} target="_blank">
                                        <div class="slds-text-heading_medium">
                                            {item.title}
                                        </div>
                                    </a>
                                    <div>{item.contentSnippet}</div>
                                </template>
                            </div>
                        </template>
                    </div>
                    <template if:true={showFooter}>
                        <footer class="slds-card__footer">
                            <a
                                class="slds-card__footer-action"
                                href="javascript:void(0);"
                                onclick={handleViewAllClick}
                            >
                                View All News
                            </a>
                        </footer>
                    </template>
                </article>
            </template>
        </div>
    </div>
</template>
